(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{48312:function(__unused_webpack_module,__unused_webpack_exports,__webpack_require__){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return __webpack_require__(64340)}])},64340:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:function(){return pages}});var jsx_runtime=__webpack_require__(85893),yup=__webpack_require__(47533),hooks=__webpack_require__(65457),icons=__webpack_require__(94937),bignumber=__webpack_require__(70794),shared=__webpack_require__(39170),Token=__webpack_require__(70417);let AmountField=param=>{var ref;let{tokenSymbol,register,setValue,name,error,disabled=!1,placeholder,showBalance=!0}=param,walletBalance=(0,hooks.C)(state=>state.walletBalance.tokens);return(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsxs)("div",{className:"flex justify-between",children:[(0,jsx_runtime.jsx)("label",{className:"ml-3 text-content-secondary text-xs font-medium mb-1",children:tokenSymbol}),showBalance&&(0,jsx_runtime.jsxs)("label",{className:"text-content-tertiary text-xs font-normal mb-1",children:["Balance"," ",(null===(ref=walletBalance.find(token=>token.symbol===tokenSymbol))||void 0===ref?void 0:ref.balance)||0," ",tokenSymbol]})]}),(0,jsx_runtime.jsxs)("div",{className:"relative text-content-primary",children:[tokenSymbol&&(0,jsx_runtime.jsx)(Token.W,{symbol:tokenSymbol,className:"absolute top-2.5 left-5 text-lg"}),(0,jsx_runtime.jsx)("input",{type:"number",step:"any",placeholder:placeholder||"Enter amount",className:"h-[40px] w-full !pl-11 !pr-[106px] ".concat(error&&"error"),disabled:disabled,...register(name)}),!disabled&&(0,jsx_runtime.jsxs)("div",{className:"flex gap-1 absolute right-2 top-2",children:[(0,jsx_runtime.jsx)(shared.zx,{size:"small",title:"MAX",className:" text-content-primary",onClick(){var ref;setValue(name,new bignumber.Z((null===(ref=walletBalance.find(token=>token.symbol===tokenSymbol))||void 0===ref?void 0:ref.balance)||0).toString())},type:"button"}),(0,jsx_runtime.jsx)(shared.zx,{size:"small",title:"HALF",className:"text-content-primary",onClick(){var ref;setValue(name,new bignumber.Z((null===(ref=walletBalance.find(token=>token.symbol===tokenSymbol))||void 0===ref?void 0:ref.balance)||0).div(2).toString())},type:"button"})]})]}),error&&(0,jsx_runtime.jsx)("p",{className:"text-content-secondary text-xs ml-[12px] mt-1",children:error})]})};var Layout=__webpack_require__(35292),react=__webpack_require__(67294),index_esm=__webpack_require__(87536),utils=__webpack_require__(43423),es=__webpack_require__(74231);let amount={amount:es.Z_().test("amount-required","Amount is required",(value,context)=>context.parent.enableStreamRate||""!==value).test("amount-negative","Amount must be greater than zero",(amount,context)=>context.parent.enableStreamRate||Number(amount)>0)},swapSchema=es.Ry().shape({amount0:amount.amount.test("check-amount-gt-balance","Amount must be less than or equal to balance",(amount0,context)=>!context.parent.balance||Number(amount0)<=context.parent.balance),amount1:amount.amount,balance:es.Z_()});var app_zebecContext=__webpack_require__(87413),useWallet=__webpack_require__(54306),toastsSlice=__webpack_require__(1629),walletBalanceSlice=__webpack_require__(98817);let initialToken1="wZBC",Home=()=>{var ref,ref1;let walletObject=(0,useWallet.O)(),dispatch=(0,hooks.T)(),walletBalance=(0,hooks.C)(state=>state.walletBalance.tokens),zebecContext=(0,react.useContext)(app_zebecContext.Z),[loading,setLoading]=(0,react.useState)(!1),[tokens,setTokens]=(0,react.useState)({token0:"ZBC",token1:initialToken1}),[tokensDisplay,setTokensDisplay]=(0,react.useState)({token0:{name:"ZBC",price:1},token1:{name:initialToken1,price:1}}),{register,handleSubmit,formState:{errors},setValue,getValues,watch,clearErrors,trigger}=(0,index_esm.cI)({mode:"onChange",resolver:(0,yup.X)(swapSchema)}),amount=watch("amount0");(0,react.useEffect)(()=>{setValue("amount1",(Number(amount)*tokensDisplay.token0.price/tokensDisplay.token1.price).toString()),trigger("amount1")},[amount]),(0,react.useEffect)(()=>{var ref;setValue("balance",new bignumber.Z((null===(ref=walletBalance.find(token=>token.symbol===tokens.token0))||void 0===ref?void 0:ref.balance)||0).toString())},[walletBalance,tokens.token0,setValue]);let swapTokensDisplay=()=>{let{token0,token1}=tokensDisplay;setTokensDisplay({token0:{name:token1.name,price:token0.price},token1:{name:token0.name,price:token0.price/token1.price}}),setTokens({token0:token1.name,token1:token0.name}),setValue("amount0",getValues().amount1),clearErrors()},refreshToInitial=()=>{setTokens({token0:"ZBC",token1:initialToken1}),setTokensDisplay({token0:{name:"ZBC",price:1},token1:{name:initialToken1,price:1}}),onComplete()},onComplete=()=>{setValue("amount0","0"),setValue("amount1","0"),setTimeout(()=>{var ref;dispatch((0,walletBalanceSlice.$)(null===(ref=walletObject.publicKey)||void 0===ref?void 0:ref.toString()))},15e3)},onSubmit=async data=>{var ref;setLoading(!0);let schemaData={payer:null===(ref=walletObject.publicKey)||void 0===ref?void 0:ref.toString(),amount:data.amount0};if("ZBC"===tokensDisplay.token0.name)try{let response=await zebecContext.swapToken.swapZbcToWzbc(schemaData);"Success"===response.status?(dispatch(toastsSlice.Am.success({message:"".concat(schemaData.amount," ZBC swapped to wZBC."),transactionHash:response.data.transactionHash})),onComplete()):dispatch(toastsSlice.Am.error({message:"Something went wrong. Try again."})),setLoading(!1)}catch(error){dispatch(toastsSlice.Am.error({message:error.message?error.message:"Something went wrong. Try again."})),setLoading(!1)}else try{let response1=await zebecContext.swapToken.swapWzbcToZbc(schemaData);"Success"===response1.status?(dispatch(toastsSlice.Am.success({message:"".concat(schemaData.amount," wZBC swapped to ZBC."),transactionHash:response1.data.transactionHash})),onComplete()):dispatch(toastsSlice.Am.error({message:"Something went wrong. Try again."})),setLoading(!1)}catch(error1){dispatch(toastsSlice.Am.error({message:error1.message?error1.message:"Something went wrong. Try again."})),setLoading(!1)}};return(0,jsx_runtime.jsx)(Layout.Z,{pageTitle:"Zebec - Swap Token",children:(0,jsx_runtime.jsx)("div",{className:"relative container pt-16 grid place-content-center",children:(0,jsx_runtime.jsxs)("div",{className:"relative w-full md:w-[628px] pb-16 bg-background-secondary rounded-[4px] p-10",children:[(0,jsx_runtime.jsx)(shared.hU,{icon:(0,jsx_runtime.jsx)(icons.Du,{}),onClick:refreshToInitial,className:"absolute right-10"}),(0,jsx_runtime.jsxs)("form",{onSubmit:handleSubmit(onSubmit),autoComplete:"off",children:[(0,jsx_runtime.jsx)("div",{className:"text-heading-4 text-content-primary font-semibold",children:"Swap Token"}),(0,jsx_runtime.jsxs)("div",{className:"text-caption text-content-tertiary font-normal pt-2",children:["Swap ",tokens.token0," to ",tokens.token1]}),(0,jsx_runtime.jsxs)("div",{className:"flex flex-col justify-between gap-[18px] mt-[50px]",children:[(0,jsx_runtime.jsx)(AmountField,{register:register,setValue:setValue,tokenSymbol:tokens.token0,name:"amount0",error:null===(ref=errors.amount0)||void 0===ref?void 0:null===(ref1=ref.message)||void 0===ref1?void 0:ref1.toString()}),(0,jsx_runtime.jsx)("div",{className:"flex justify-center relative w-full",children:(0,jsx_runtime.jsxs)("div",{className:"flex justify-start items-center gap-2",children:[(0,jsx_runtime.jsx)("div",{className:"grid place-content-center w-8 h-8 rounded-full bg-background-light",children:(0,jsx_runtime.jsx)(icons.T8,{className:"cursor-pointer text-content-secondary w-6 h-6 transform rotate-90",onClick:swapTokensDisplay})}),(0,jsx_runtime.jsxs)("span",{className:"text-base text-content-secondary",children:[tokensDisplay.token0.price," ",tokensDisplay.token0.name," ="," ",(0,jsx_runtime.jsx)("span",{"data-tip":(0,utils.Pb)(tokensDisplay.token1.price),children:tokensDisplay.token1.price})," ",tokensDisplay.token1.name]})]})}),(0,jsx_runtime.jsx)(AmountField,{register:register,setValue:setValue,tokenSymbol:tokens.token1,name:"amount1",error:"",placeholder:"0",disabled:!0,showBalance:!1})]}),(0,jsx_runtime.jsx)(shared.zx,{variant:"gradient",title:"Swap ".concat(Number(getValues().amount0)>0?"- ".concat(getValues().amount0," ").concat(tokens.token0):""),className:"mt-[21px] w-full",type:"submit",loading:loading,disabled:loading})]})]})})})};var pages=Home}},function(__webpack_require__){__webpack_require__.O(0,[193,491,802,774,888,179],function(){return __webpack_require__(__webpack_require__.s=48312)}),_N_E=__webpack_require__.O()}]);